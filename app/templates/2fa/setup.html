{% extends 'layout.html' %}
{% block content %}
    <div class="row">
        <h3 class="display-3">2단계 인증</h3>
    {% if request.args.get("e") == "fail" %}
        <div class="alert alert-danger">
            <p class="mb-0">유효하지 않은 인증 토큰이 입력되었습니다</p>
        </div>
    {% elif request.args.get("e") == "missing" %}
        <div class="alert alert-danger">
            <p class="mb-0">인증 토큰을 입력해야 합니다</p>
        </div>
    {% endif %}
        <form method="post">
            <div class="mb-3 row">
                <label for="qrcode" class="col-sm-2 col-form-label">QR코드</label>
                <div class="col-sm-10">
                    <img id="qrcode" style="width:200px" src="{{ url_for('2fa.qrcode') }}">
                </div>
            </div>

            <div class="mb-3 row">
                <label for="otp_pin" class="col-sm-2 col-form-label">인증 토큰</label>
                <div class="col-sm-10">
                    <input type="tel" class="form-control" id="otp_pin" name="otp_pin" required="required">
                </div>
            </div>
            <br>
            <button type="submit" class="btn btn-primary btn-lg">등록하기</button>
        </form>
    </div>
{% endblock %}